(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5819],{75819:function(e,s,t){"use strict";t.d(s,{Z:function(){return K}});var n=t(51351),a=t(85893),r=t(67294),i=(t(22497),t(59145),t(41830),t(47568)),l=t(828),o=t(70655),u=t(25675),c=t.n(u),d=t(64678),v=t(48677),f=t(45424),m=(t(4069),"kv3mxk3"),x=t(84709),p=t(99505),h=t(26295),j=t(74990),b=t(79650),k=t(70751),C=t(68146),y=t(32292),N=t(54677),A=t(1863),Z=t(17248),_=t(88767),g=t(28424),S=t(65113),T=t(63323),w=t(48098),I=t(28432),F=t(69931),E=t(95678),O=t(87862),P=x.uf.format,R=x.uf.formatPercent,U=(x.uf.formatERC20,x.uf.parse),V=x.uf.formatShortName,Q=function(e){e=null!==e?e:(0,n.Z)(new TypeError("Cannot destructure undefined"));var s=(0,A.Z)((function(e){return e.setIsSidebarVisibleInMobile})),t=(0,r.useContext)(Z.S).currentUser,u=(0,_.useQueryClient)(),x=(null===t||void 0===t?void 0:t.address)||"",Q=(0,S.Z)((function(e){return e.HERC20ContractAddr})),W=(0,y.U)(Q),q=W.htokenHelperContractAddress,L=W.ERC20ContractAddress,D=W.erc20Name,M=(W.erc20Icon,W.name),z=W.icon,Y=W.unit,H=W.formatDecimals,B=(0,S.Z)((function(e){return e.setWorkflow})),J=(0,l.Z)((0,N.fv)(q,Q),2),K=J[0],$=J[1],G=(0,l.Z)((0,T.aE)(L,t,Y),2),X=G[0],ee=G[1],se=(0,l.Z)((0,N.OC)(q,Q,t,Y),2),te=se[0],ne=se[1],ae=(0,l.Z)((0,N.sM)(q,Q,Y),2),re=ae[0],ie=ae[1],le=(0,l.Z)((0,w.Os)(Q,Y),2),oe=le[0],ue=le[1],ce=(0,l.Z)((0,F.Af)(t,E.s,q),2),de=ce[0],ve=ce[1],fe=(0,r.useState)(0),me=fe[0],xe=fe[1],pe=(0,r.useState)(0),he=pe[0],je=pe[1],be=(0,r.useState)(0),ke=be[0],Ce=be[1],ye=(0,l.Z)((0,T.Jw)(L,Q,t,he,Y),2),Ne=ye[0],Ae=ye[1],Ze=(0,C.Z)(),_e=Ze.toast,ge=Ze.ToastComponent,Se=(0,C.Z)(),Te=Se.toast,we=Se.ToastComponent,Ie=(0,r.useState)("WAIT_FOR_APPROVAL"),Fe=Ie[0],Ee=Ie[1],Oe=parseFloat(re),Pe=parseFloat(oe),Re=parseFloat(te),Ue=Pe/(Oe+Pe)*100,Ve=parseFloat(X);(0,r.useEffect)((function(){$||ee||ne||ie||ue||Ae||ve?_e.processing("Loading"):(We(),_e.clear(0))}),[$,ee,ne,ie,ue,Ae,ve,Ne]);var Qe=function(e){if(!e)return xe(0),je(0),void Ce(0);xe(e),je(e/K),Ce(e/K)},We=function(){Ee(Ne?"WAIT_FOR_DEPOSIT":"WAIT_FOR_APPROVAL")},qe=(0,_.useMutation)(T.l$),Le=(0,_.useMutation)(w.lt),De=function(){var e=(0,i.Z)((function(){var e,s,t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,12,,13]),Te.processing(),"WAIT_FOR_APPROVAL"!=Fe?[3,3]:(e={},[4,qe.mutateAsync((e.ERC20ContractAddress=L,e.contractAddress=Q,e))]);case 1:return n.sent(),console.log("Approval succeed"),[4,u.invalidateQueries(I.a.userApproval(x,L,Q))];case 2:return n.sent(),[3,11];case 3:return"WAIT_FOR_DEPOSIT"!=Fe?[3,11]:(s={},[4,Le.mutateAsync((s.HERC20ContractAddress=Q,s.amount=he.toFixed(18).toString(),s.unit=Y,s))]);case 4:return n.sent(),[4,u.invalidateQueries(I.a.totalSupply(Q))];case 5:return n.sent(),[4,u.invalidateQueries(I.a.userTotalSupply(x,Q))];case 6:return n.sent(),[4,u.invalidateQueries(I.a.userBalance(x,L))];case 7:return n.sent(),[4,u.invalidateQueries(I.a.listUserUnderlying(x))];case 8:return n.sent(),[4,u.invalidateQueries(I.a.lendData(Q))];case 9:return n.sent(),[4,u.invalidateQueries(I.a.userApproval(x,L,Q))];case 10:n.sent(),console.log("deposit succeed"),Qe(void 0),n.label=11;case 11:return Te.success("Successful! Transaction complete"),[3,13];case 12:return t=n.sent(),console.error(t),Te.error("Sorry! Transaction failed"),[3,13];case 13:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Me=Te.state?we:ge;return(0,a.jsx)(j.Z,{footer:(null===_e||void 0===_e?void 0:_e.state)||Te.state?Me:(0,a.jsxs)("div",{className:"kv3mxk9",children:[(0,a.jsx)("div",{className:"kv3mxka",children:(0,a.jsx)(p.Z,{variant:"secondary",onClick:function(){return s(!1),B(g.ky.none),void document.body.classList.remove("disable-scroll")},children:"Cancel"})}),(0,a.jsx)("div",{className:"kv3mxkb",children:(0,a.jsx)(p.Z,{variant:"primary",disabled:0===Ve||he>Ve,isFluid:!0,onClick:De,children:(0,a.jsx)(a.Fragment,{children:0===Ve||he>Ve?"Insufficient balance":"WAIT_FOR_APPROVAL"==Fe?"Approve":"WAIT_FOR_DEPOSIT"==Fe?"Deposit":void 0})})})]}),children:(0,a.jsxs)("div",{className:"kv3mxk0",children:[(0,a.jsxs)("div",{className:"kv3mxk4 kv3mxk2 kv3mxk1",children:[(0,a.jsx)("div",{className:"kv3mxk5",children:(0,a.jsx)(h.Z,{children:(0,a.jsx)(c(),{src:z,alt:M,layout:"fill"})})}),(0,a.jsx)("div",{className:"kv3mxk6",children:M})]}),(0,a.jsxs)("div",{className:"kv3mxk2 kv3mxk1",children:[(0,a.jsx)("div",{className:m,children:(0,a.jsx)(d.U,{value:V(Re,H),valueSize:"big",footer:(0,a.jsx)("span",{children:"Your Deposits"})})}),(0,a.jsx)("div",{className:m,children:(0,a.jsx)(d.U,{value:R((0,O.JE)(de,Q),2),valueSize:"big",toolTipLabel:"APY is measured by compounding the weekly interest rate",footer:(0,a.jsxs)("span",{className:k.mv,children:["Estimated APY ",(0,a.jsx)("div",{className:b.Pt})]})})}),(0,a.jsx)("div",{className:m,children:(0,a.jsx)(d.U,{value:R(Ue,2),valueSize:"big",toolTipLabel:" Amount of supplied liquidity currently being borrowed",footer:(0,a.jsxs)("span",{className:k.mv,children:["Utilization rate ",(0,a.jsx)("div",{className:b.Pt})]})})})]}),(0,a.jsx)("div",{className:"kv3mxk8",children:(0,a.jsx)(v.h,{firstInputValue:U(P(he)),secondInputValue:U(P(me)),onChangeFirstInput:function(e){if(!e)return xe(0),je(0),void Ce(0);xe(e*K),je(e),Ce(e)},onChangeSecondInput:Qe,maxValue:Ve,firstInputAddon:D})}),(0,a.jsx)(f.Q,{currentValue:ke,maxValue:Ve,minAvailableValue:0,onChange:function(e){Ce(e),xe(e*K),je(e)}})]})})},W=t(958),q=t(56242),L=(t(39127),"_16qtxbu3"),D=t(61154),M=x.uf.format,z=x.uf.formatPercent,Y=x.uf.formatERC20,H=x.uf.parse,B=(x.uf.formatShortName,function(e){e=null!==e?e:(0,n.Z)(new TypeError("Cannot destructure undefined"));var s=(0,A.Z)((function(e){return e.setIsSidebarVisibleInMobile})),t=(0,r.useContext)(Z.S),u=t.currentUser,m=(t.setCurrentUser,(0,_.useQueryClient)()),x=(null===u||void 0===u?void 0:u.address)||"",T=(0,S.Z)((function(e){return e.HERC20ContractAddr})),P=(0,y.U)(T),R=P.htokenHelperContractAddress,U=P.ERC20ContractAddress,V=P.name,Q=P.icon,W=P.erc20Name,q=P.unit,B=P.formatDecimals,J=(0,S.Z)((function(e){return e.setWorkflow})),K=(0,l.Z)((0,N.fv)(R,T),2),$=K[0],G=K[1],X=(0,l.Z)((0,N.OC)(R,T,u,q),2),ee=X[0],se=X[1],te=(0,l.Z)((0,N.sM)(R,T,q),2),ne=te[0],ae=te[1],re=(0,l.Z)((0,w.Os)(T,q),2),ie=re[0],le=re[1],oe=(0,l.Z)((0,F.Af)(u,E.s,R),2),ue=oe[0],ce=oe[1],de=(0,r.useState)(0),ve=de[0],fe=de[1],me=(0,r.useState)(0),xe=me[0],pe=me[1],he=(0,r.useState)(0),je=he[0],be=he[1],ke=(0,C.Z)(),Ce=ke.toast,ye=ke.ToastComponent,Ne=(0,C.Z)(),Ae=Ne.toast,Ze=Ne.ToastComponent,_e=parseFloat(ee),ge=parseFloat(ne),Se=parseFloat(ie),Te=Se/(ge+Se)*100;(0,r.useEffect)((function(){G||se||ae||le||ce?Ce.processing("Loading"):Ce.clear()}),[G,se,ae,le,ce]);var we=function(e){be(e),fe(e*$),pe(e)},Ie=function(){var e=(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,D.wu)(T,_e,je,q,ee)];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Fe=(0,_.useMutation)(Ie),Ee=function(){var e=(0,i.Z)((function(){var e;return(0,o.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,7,,8]),Ae.processing(),[4,Fe.mutateAsync()];case 1:return s.sent(),console.log("Redeem Succeed"),[4,m.invalidateQueries(I.a.totalSupply(T))];case 2:return s.sent(),[4,m.invalidateQueries(I.a.userTotalSupply(x,T))];case 3:return s.sent(),[4,m.invalidateQueries(I.a.userBalance(x,U))];case 4:return s.sent(),[4,m.invalidateQueries(I.a.listUserUnderlying(x))];case 5:return s.sent(),[4,m.invalidateQueries(I.a.lendData(T))];case 6:return s.sent(),we(0),Ae.success("Successful! Transaction complete"),[3,8];case 7:return e=s.sent(),console.error(e),Ae.error("Sorry! Transaction failed"),[3,8];case 8:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Oe=Ae.state?Ze:ye;return(0,a.jsx)(j.Z,{footer:(null===Ce||void 0===Ce?void 0:Ce.state)||Ae.state?Oe:(0,a.jsxs)("div",{className:"_16qtxbu9",children:[(0,a.jsx)("div",{className:"_16qtxbua",children:(0,a.jsx)(p.Z,{variant:"secondary",onClick:function(){s(!1),J(g.ky.none),document.body.classList.remove("disable-scroll")},children:"Cancel"})}),(0,a.jsx)("div",{className:"_16qtxbub",children:(0,a.jsx)(p.Z,{variant:"primary",disabled:0===_e||xe>_e,isFluid:!0,onClick:Ee,children:0===_e||xe>_e?"Insufficient balance":"Withdraw"})})]}),children:(0,a.jsxs)("div",{className:"_16qtxbu0",children:[(0,a.jsxs)("div",{className:"_16qtxbu4 _16qtxbu2 _16qtxbu1",children:[(0,a.jsx)("div",{className:"_16qtxbu5",children:(0,a.jsx)(h.Z,{children:(0,a.jsx)(c(),{src:Q,alt:V,layout:"fill"})})}),(0,a.jsx)("div",{className:"_16qtxbu6",children:V})]}),(0,a.jsxs)("div",{className:"_16qtxbu2 _16qtxbu1",children:[(0,a.jsx)("div",{className:L,children:(0,a.jsx)(d.U,{value:Y(_e,B),valueSize:"big",footer:(0,a.jsx)("span",{children:"Your Deposits"})})}),(0,a.jsx)("div",{className:L,children:(0,a.jsx)(d.U,{value:z((0,O.JE)(ue,T),2),valueSize:"big",toolTipLabel:"APY is measured by compounding the weekly interest rate",footer:(0,a.jsxs)("span",{className:k.mv,children:["Estimated APY ",(0,a.jsx)("div",{className:b.Pt})]})})}),(0,a.jsx)("div",{className:L,children:(0,a.jsx)(d.U,{value:z(Te,2),valueSize:"big",toolTipLabel:" Amount of supplied liquidity currently being borrowed",footer:(0,a.jsxs)("span",{className:k.mv,children:["Utilization rate ",(0,a.jsx)("div",{className:b.Pt})]})})})]}),(0,a.jsx)("div",{className:"_16qtxbu8",children:(0,a.jsx)(v.h,{firstInputValue:H(M(xe)),secondInputValue:H(M(ve)),onChangeFirstInput:function(e){if(!e)return fe(0),pe(0),void be(0);fe(e*$),pe(e),be(e)},onChangeSecondInput:function(e){if(!e)return fe(0),pe(0),void be(0);fe(e),pe(e/$),be(e/$)},maxValue:_e,firstInputAddon:W})}),(0,a.jsx)(f.Q,{currentValue:je,maxValue:_e,minAvailableValue:0,onChange:we})]})})}),J=t(37982),K=function(e){e=null!==e?e:(0,n.Z)(new TypeError("Cannot destructure undefined"));var s=(0,S.Z)((function(e){return e.workflow})),t=(0,J.We)().openConnectModal,i=((0,_.useQueryClient)(),[{label:"Deposit",key:"deposit"},{label:"Withdraw",key:"withdraw",disabled:Boolean(s!=g.ky.lendOrWithdraw)}]),l=(0,r.useState)("deposit"),o=l[0],u=l[1],c=(0,r.useContext)(Z.S).currentUser;return(0,a.jsx)("div",{className:"_2krgsf0 _1c1tagj1",children:(0,a.jsx)(W.Z,{activeKey:o,onTabChange:function(e){u(e)},items:i,active:!0,children:c?s==g.ky.lendOrWithdraw&&"deposit"==o?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Q,{})}):s==g.ky.lendOrWithdraw&&"withdraw"==o?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(B,{})}):(0,a.jsx)(q.Z,{icon:(0,a.jsx)("div",{className:"_2krgsf2"}),title:"Manage panel",description:"First, choose a NFT collection"}):(0,a.jsx)(q.Z,{icon:(0,a.jsx)("div",{className:"_2krgsf3"}),title:"You didn\u2019t connect any wallet yet",description:"First, choose a NFT collection",buttons:[{title:"CONNECT WALLET",onClick:t}]})})})}},4069:function(){},41830:function(){},39127:function(){}}]);